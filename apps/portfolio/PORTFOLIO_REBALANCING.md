# üîÑ Portfolio Rebalancing Engine

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Ü–µ–ª–µ–≤—ã—Ö –≤–µ—Å–æ–≤ –∞–∫—Ç–∏–≤–æ–≤.

## üéØ –ß—Ç–æ —ç—Ç–æ

**Portfolio Rebalancing** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ—Ü–µ—Å—Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è –∫ —Ü–µ–ª–µ–≤—ã–º –≤–µ—Å–∞–º –∞–∫—Ç–∏–≤–æ–≤ –ø–æ—Å–ª–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –∏–∑-–∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω.

**–ó–∞—á–µ–º –Ω—É–∂–Ω–æ:**

- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ü–µ–ª–µ–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å —Ä–∏—Å–∫–∞/–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
- –§–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–±—ã–ª—å –æ—Ç –≤—ã—Ä–æ—Å—à–∏—Ö –∞–∫—Ç–∏–≤–æ–≤
- –î–æ–∫—É–ø–∞—Ç—å –ø–æ–¥–µ—à–µ–≤–µ–≤—à–∏–µ –∞–∫—Ç–∏–≤—ã
- –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ –∫ —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–µ

## üìê –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏

### 1. Periodic (–ö–∞–ª–µ–Ω–¥–∞—Ä–Ω–∞—è)

**–û–ø–∏—Å–∞–Ω–∏–µ:** –†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ/–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ/–µ–∂–µ–º–µ—Å—è—á–Ω–æ/–µ–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ)

**–ü–ª—é—Å—ã:**

- –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–¥–µ—Ä–∂–∫–∏ –Ω–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –î–∏—Å—Ü–∏–ø–ª–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥

**–ú–∏–Ω—É—Å—ã:**

- –ú–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –º–µ–∂–¥—É –¥–∞—Ç–∞–º–∏
- –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ä—ã–Ω–æ—á–Ω—É—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

- –î–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π
- –ö–æ–≥–¥–∞ –≤–∞–∂–Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å
- –î–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ–º–∏—Å—Å–∏–π

### 2. Threshold (–ü–æ—Ä–æ–≥–æ–≤–∞—è)

**–û–ø–∏—Å–∞–Ω–∏–µ:** –†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ –≤–µ—Å–∞ –∞–∫—Ç–∏–≤–∞ –æ—Ç —Ü–µ–ª–µ–≤–æ–≥–æ –Ω–∞ –∑–∞–¥–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç

**–ü–ª—é—Å—ã:**

- –†–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –±–æ–ª—å—à–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
- –ì–∏–±–∫–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Ä–æ–≥–æ–≤

**–ú–∏–Ω—É—Å—ã:**

- –¢—Ä–µ–±—É–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –ú–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ–π –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

- –î–ª—è –∞–∫—Ç–∏–≤–Ω–æ —É–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π
- –ö–æ–≥–¥–∞ –≤–∞–∂–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª—å —Ä–∏—Å–∫–∞
- –í –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã—Ö —Ä—ã–Ω–∫–∞—Ö

### 3. Opportunistic (–û–ø–ø–æ—Ä—Ç—É–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∞—è)

**–û–ø–∏—Å–∞–Ω–∏–µ:** –†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã—Ö —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö

**–ü–ª—é—Å—ã:**

- –£—á–∏—Ç—ã–≤–∞–µ—Ç —Ä—ã–Ω–æ—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –ª—É—á—à–∏–µ —Ü–µ–Ω—ã –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
- –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è slippage

**–ú–∏–Ω—É—Å—ã:**

- –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è "–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π"
- –ú–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

- –î–ª—è –æ–ø—ã—Ç–Ω—ã—Ö —Ç—Ä–µ–π–¥–µ—Ä–æ–≤
- –í —Å–ø–æ–∫–æ–π–Ω—ã—Ö —Ä—ã–Ω–∫–∞—Ö —Å —Ö–æ—Ä–æ—à–µ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å—é
- –ö–æ–≥–¥–∞ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ä—ã–Ω–æ—á–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–µ

### 4. Hybrid (–ì–∏–±—Ä–∏–¥–Ω–∞—è)

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ö–æ–º–±–∏–Ω–∞—Ü–∏—è Periodic –∏ Threshold —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

**–ü–ª—é—Å—ã:**

- –õ—É—á—à–µ–µ –∏–∑ –æ–±–æ–∏—Ö –º–∏—Ä–æ–≤
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ (periodic)
- –†–µ–∞–∫—Ü–∏—è –Ω–∞ –±–æ–ª—å—à–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è (threshold)

**–ú–∏–Ω—É—Å—ã:**

- –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

- –î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π (recommended)
- –ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —á–∞—Å—Ç–æ—Ç–æ–π –∏ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º

## üîß API Endpoints

### 1. Analyze Rebalancing

**Endpoint:** `POST /api/portfolio/:id/rebalancing/analyze`

–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π.

**Request Body:**

```json
{
  "targetWeights": {
    "BTCUSDT": 0.5,
    "ETHUSDT": 0.3,
    "SOLUSDT": 0.2
  },
  "config": {
    "strategy": "hybrid",
    "frequency": "monthly",
    "thresholdPercent": 0.05,
    "minTradeSize": 10,
    "maxTransactionCost": 0.002,
    "allowPartialRebalance": false
  }
}
```

**Config Parameters:**

- `strategy`: "periodic" | "threshold" | "opportunistic" | "hybrid"
- `frequency` (periodic): "daily" | "weekly" | "monthly" | "quarterly"
- `thresholdPercent` (threshold): –ø–æ—Ä–æ–≥ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è (0.05 = 5%)
- `minTradeSize`: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Å–¥–µ–ª–∫–∏ –≤ USD
- `maxTransactionCost`: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è –≤ % –æ—Ç –ø–æ—Ä—Ç—Ñ–µ–ª—è
- `allowPartialRebalance`: —Ä–∞–∑—Ä–µ—à–∏—Ç—å —á–∞—Å—Ç–∏—á–Ω—É—é —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É

**Response:**

```json
{
  "success": true,
  "data": {
    "needsRebalancing": true,
    "reason": "BTCUSDT deviated by 8.5% (threshold: 5.0%)",
    "totalValue": 10000,
    "actions": [
      {
        "symbol": "BTCUSDT",
        "action": "sell",
        "currentWeight": 0.58,
        "targetWeight": 0.5,
        "currentValue": 5800,
        "targetValue": 5000,
        "deltaValue": -800,
        "deltaQuantity": -0.008,
        "estimatedCost": 1.2
      },
      {
        "symbol": "ETHUSDT",
        "action": "buy",
        "currentWeight": 0.25,
        "targetWeight": 0.3,
        "currentValue": 2500,
        "targetValue": 3000,
        "deltaValue": 500,
        "deltaQuantity": 0.5,
        "estimatedCost": 0.75
      }
    ],
    "totalTransactionCost": 1.95,
    "estimatedSlippage": 0.0005,
    "netBenefit": 0.083,
    "priority": "medium"
  },
  "timestamp": 1696435200000
}
```

### 2. Execute Rebalancing

**Endpoint:** `POST /api/portfolio/:id/rebalancing/execute`

–í—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ä–¥–µ—Ä–∞).

**Request Body:**

```json
{
  "plan": {
    // ... plan from analyze endpoint
  },
  "dryRun": true
}
```

**Parameters:**

- `plan`: –ø–ª–∞–Ω —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –æ—Ç analyze endpoint
- `dryRun` (optional): –µ—Å–ª–∏ true, —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞–∑–∞—Ç—å –æ—Ä–¥–µ—Ä–∞ –±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (default: true)

**Response:**

```json
{
  "success": true,
  "data": {
    "orders": [
      {
        "symbol": "BTCUSDT",
        "side": "SELL",
        "quantity": 0.008,
        "type": "LIMIT",
        "price": 100000
      },
      {
        "symbol": "ETHUSDT",
        "side": "BUY",
        "quantity": 0.5,
        "type": "LIMIT",
        "price": 1000
      }
    ],
    "dryRun": true
  },
  "timestamp": 1696435200000
}
```

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. Threshold Strategy (5% –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ)

```bash
curl -X POST "http://localhost:3012/api/portfolio/my-portfolio/rebalancing/analyze" \
  -H "Content-Type: application/json" \
  -H "x-user-id: user123" \
  -d '{
    "targetWeights": {
      "BTCUSDT": 0.60,
      "ETHUSDT": 0.40
    },
    "config": {
      "strategy": "threshold",
      "thresholdPercent": 0.05,
      "minTradeSize": 10
    }
  }'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞, –µ—Å–ª–∏ –ª—é–±–æ–π –∞–∫—Ç–∏–≤ –æ—Ç–∫–ª–æ–Ω–∏–ª—Å—è –Ω–∞ >5% –æ—Ç —Ü–µ–ª–µ–≤–æ–≥–æ –≤–µ—Å–∞.

### 2. Periodic Strategy (Monthly)

```bash
curl -X POST "http://localhost:3012/api/portfolio/my-portfolio/rebalancing/analyze" \
  -H "Content-Type: application/json" \
  -H "x-user-id: user123" \
  -d '{
    "targetWeights": {
      "BTCUSDT": 0.50,
      "ETHUSDT": 0.30,
      "SOLUSDT": 0.20
    },
    "config": {
      "strategy": "periodic",
      "frequency": "monthly"
    }
  }'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ —Ä–∞–∑ –≤ –º–µ—Å—è—Ü, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π.

### 3. Hybrid Strategy (Best of Both)

```bash
curl -X POST "http://localhost:3012/api/portfolio/my-portfolio/rebalancing/analyze" \
  -H "Content-Type: application/json" \
  -H "x-user-id: user123" \
  -d '{
    "targetWeights": {
      "BTCUSDT": 0.40,
      "ETHUSDT": 0.30,
      "SOLUSDT": 0.20,
      "BNBUSDT": 0.10
    },
    "config": {
      "strategy": "hybrid",
      "frequency": "monthly",
      "thresholdPercent": 0.10,
      "minTradeSize": 50
    }
  }'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ —Ä–∞–∑ –≤ –º–µ—Å—è—Ü –ò–õ–ò –µ—Å–ª–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ >10%.

### 4. Execute Rebalancing (Dry-Run)

```bash
curl -X POST "http://localhost:3012/api/portfolio/my-portfolio/rebalancing/execute" \
  -H "Content-Type: application/json" \
  -H "x-user-id: user123" \
  -d '{
    "plan": { /* ... plan from analyze */ },
    "dryRun": true
  }'
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Ä–¥–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã, –±–µ–∑ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

## üìä –†–∞—Å—á–µ—Ç –∏–∑–¥–µ—Ä–∂–µ–∫

### Transaction Cost

```
Transaction Cost = Fee + Slippage
```

- **Fee:** –ö–æ–º–∏—Å—Å–∏—è –±–∏—Ä–∂–∏ (maker fee, –æ–±—ã—á–Ω–æ ~0.1%)
- **Slippage:** –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ç –æ–∂–∏–¥–∞–µ–º–æ–π (~0.05%)

### Net Benefit

```
Net Benefit = Deviation - (Transaction Cost / Portfolio Value)
```

- **Deviation:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –≤–µ—Å–∞ –æ—Ç —Ü–µ–ª–µ–≤–æ–≥–æ
- **Transaction Cost:** –û–±—â–∏–µ –∏–∑–¥–µ—Ä–∂–∫–∏ –Ω–∞ —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**

- **Net Benefit > 0:** –†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –≤—ã–≥–æ–¥–Ω–∞
- **Net Benefit < 0:** –ò–∑–¥–µ—Ä–∂–∫–∏ –ø—Ä–µ–≤—ã—à–∞—é—Ç –ø–æ–ª—å–∑—É

## üéØ Priority Levels

| Priority   | Max Deviation | –î–µ–π—Å—Ç–≤–∏–µ                  |
| ---------- | ------------- | ------------------------- |
| **Low**    | 3-7%          | –ú–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å            |
| **Medium** | 7-10%         | –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–∞ —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ |
| **High**   | >10%          | –°—Ä–æ—á–Ω–∞—è —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞    |

## ‚ö†Ô∏è Best Practices

### 1. –í—ã–±–æ—Ä –ø–æ—Ä–æ–≥–∞ (Threshold)

```
Low Volatility Assets  ‚Üí 3-5% threshold
Medium Volatility      ‚Üí 5-7% threshold
High Volatility        ‚Üí 7-10% threshold
```

### 2. –ß–∞—Å—Ç–æ—Ç–∞ —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏

```
Long-term Portfolio    ‚Üí Monthly/Quarterly
Active Portfolio       ‚Üí Weekly
Trading Portfolio      ‚Üí Threshold-based
```

### 3. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Å–¥–µ–ª–∫–∏

```
minTradeSize ‚â• Transaction Cost √ó 10
```

–ü—Ä–∏–º–µ—Ä: –ï—Å–ª–∏ –∫–æ–º–∏—Å—Å–∏—è $0.50, —Ç–æ `minTradeSize ‚â• $5`

### 4. –£—á–µ—Ç –Ω–∞–ª–æ–≥–æ–≤

- –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —é—Ä–∏—Å–¥–∏–∫—Ü–∏—è—Ö —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ = taxable event
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å tax-loss harvesting
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–≥–æ–¥–Ω–µ–µ –¥–ª—è –Ω–∞–ª–æ–≥–æ–≤

## üßÆ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –†–∞—Å—á–µ—Ç —Ç–µ–∫—É—â–∏—Ö –≤–µ—Å–æ–≤

```typescript
currentWeight_i = positionValue_i / totalPortfolioValue
```

### –†–∞—Å—á–µ—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è

```typescript
deviation_i = |currentWeight_i - targetWeight_i|
```

### –†–∞—Å—á–µ—Ç –Ω—É–∂–Ω–æ–≥–æ –æ–±—ä–µ–º–∞

```typescript
deltaValue_i = totalValue √ó (targetWeight_i - currentWeight_i)
deltaQuantity_i = deltaValue_i / currentPrice_i
```

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è

```typescript
if (deltaValue > minTradeSize) ‚Üí BUY
if (deltaValue < -minTradeSize) ‚Üí SELL
else ‚Üí HOLD
```

## üìà –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏

1. **Risk Control:** –ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è —Ä–∏—Å–∫–∞
2. **Buy Low, Sell High:** –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏
3. **Discipline:** –£–¥–∞–ª–µ–Ω–∏–µ —ç–º–æ—Ü–∏–π –∏–∑ –ø—Ä–æ—Ü–µ—Å—Å–∞
4. **Drift Prevention:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —á—Ä–µ–∑–º–µ—Ä–Ω–æ–π –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏

## üöß –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **Transaction Costs:** –ß–∞—Å—Ç–∞—è —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∏–∑–¥–µ—Ä–∂–∫–∏
2. **Market Impact:** –ë–æ–ª—å—à–∏–µ –æ—Ä–¥–µ—Ä–∞ –º–æ–≥—É—Ç –¥–≤–∏–≥–∞—Ç—å —Ä—ã–Ω–æ–∫
3. **Tax Implications:** –ú–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å taxable events
4. **Market Timing:** –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç momentum –∏ trends

## üöÄ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### Planned:

1. **Tax-Aware Rebalancing** ‚Äî —É—á–µ—Ç –Ω–∞–ª–æ–≥–æ–≤—ã—Ö –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π
2. **Slippage Prediction** ‚Äî ML-–º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è slippage
3. **Market Impact Modeling** ‚Äî –æ—Ü–µ–Ω–∫–∞ –≤–ª–∏—è–Ω–∏—è –æ—Ä–¥–µ—Ä–æ–≤ –Ω–∞ —Ä—ã–Ω–æ–∫
4. **Multi-Exchange Rebalancing** ‚Äî —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –º–µ–∂–¥—É –±–∏—Ä–∂–∞–º–∏
5. **Dynamic Thresholds** ‚Äî –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
6. **Risk Parity Rebalancing** ‚Äî —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–∏—Å–∫—É, –∞ –Ω–µ –ø–æ –≤–µ—Å–∞–º
7. **Transaction Cost Optimization** ‚Äî –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –º–µ–∂–¥—É limit/market

## üìö –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞

1. **Markowitz, H. (1991)** - "Portfolio Selection: Efficient Diversification of Investments"
2. **Sharpe, W. (2010)** - "Adaptive Asset Allocation Policies"
3. **Jaconetti et al. (2010)** - "Best Practices for Portfolio Rebalancing" - Vanguard
4. **DeMiguel et al. (2009)** - "Optimal Versus Naive Diversification"

## üîó –°–º. —Ç–∞–∫–∂–µ

- [Portfolio Optimization](./PORTFOLIO_OPTIMIZATION.md)
- [Risk Management](../../risk/ADVANCED_RISK_METRICS.md)
- [Aladdin Roadmap](../../../docs/ALADDIN_ROADMAP.md)
