# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã —Ä–æ–ª–µ–π –∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `role` –≤ –º–æ–¥–µ–ª—å `User` (–∑–Ω–∞—á–µ–Ω–∏—è: `user`, `admin`)
- –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è `20251006130159_add_user_role`
- –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ —Ä–æ–ª—å `user` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

### 2. –°–æ–∑–¥–∞–Ω API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

**Endpoints:**

- `GET /api/admin/users` - —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `GET /api/admin/users/:userId` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- `PATCH /api/admin/users/:userId/role` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `DELETE /api/admin/users/:userId` - —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ó–∞—â–∏—Ç–∞:**

- –í—Å–µ admin endpoints –∑–∞—â–∏—â–µ–Ω—ã middleware `adminMiddleware`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å
- –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ `audit_logs`

### 3. –û–±–Ω–æ–≤–ª–µ–Ω —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥

- –í —Å–∞–π–¥–±–∞—Ä–µ –¥–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ" (–≤–∏–¥–∏–º —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∞–º)
- –°–æ–∑–¥–∞–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ `/admin/users` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–æ–ª–µ–π –∏ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –†–∞—Å—à–∏—Ä–µ–Ω—ã —Ç–∏–ø—ã Better-Auth –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ä–æ–ª–∏

## üöÄ –ö–∞–∫ –Ω–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –®–∞–≥ 1: –ù–∞–∑–Ω–∞—á–∏—Ç—å –ø–µ—Ä–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º:

```bash
bun run scripts/make-admin.ts admin@example.com
```

–°–∫—Ä–∏–ø—Ç:

- –ù–∞–π–¥–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email
- –ò–∑–º–µ–Ω–∏—Ç –µ–≥–æ —Ä–æ–ª—å –Ω–∞ `admin`
- –°–æ–∑–¥–∞—Å—Ç –∑–∞–ø–∏—Å—å –≤ audit log

### –®–∞–≥ 2: –í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É

1. –ó–∞–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Å —Ä–æ–ª—å—é `admin`
2. –í —Å–∞–π–¥–±–∞—Ä–µ –ø–æ—è–≤–∏—Ç—Å—è —Ä–∞–∑–¥–µ–ª "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ"
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏"

### –®–∞–≥ 3: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –≤—ã –º–æ–∂–µ—Ç–µ:

- **–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** —Å –∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π:

  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ä–¥–µ—Ä–æ–≤
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –±–∏—Ä–∂
  - –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
  - –°—Ç–∞—Ç—É—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è email

- **–ò–∑–º–µ–Ω—è—Ç—å —Ä–æ–ª–∏** —á–µ—Ä–µ–∑ dropdown –º–µ–Ω—é (user ‚Üî admin)

- **–£–¥–∞–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** (—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º)
  - ‚ö†Ô∏è –í—ã –Ω–µ –º–æ–∂–µ—Ç–µ —É–¥–∞–ª–∏—Ç—å —Å–∞–º–æ–≥–æ —Å–µ–±—è
  - ‚ö†Ô∏è –£–¥–∞–ª–µ–Ω–∏–µ cascade ‚Äî —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

### Backend

- `apps/server/src/middleware/admin.ts` - middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ admin —Ä–æ–ª–∏
- `apps/server/src/routers/admin-users.ts` - API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `apps/server/src/index.ts` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ admin —Ä–æ—É—Ç–µ—Ä–∞

### Frontend

- `apps/web/src/routes/_auth.admin.users.tsx` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `apps/web/src/components/app-sidebar.tsx` - –æ–±–Ω–æ–≤–ª–µ–Ω —Å–∞–π–¥–±–∞—Ä —Å —Ä–∞–∑–¥–µ–ª–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
- `apps/web/src/lib/auth-types.ts` - —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ Better-Auth

### Database

- `packages/database/prisma/schema/schema.prisma` - –º–æ–¥–µ–ª—å User —Å –ø–æ–ª–µ–º role
- `packages/database/prisma/migrations/20251006130159_add_user_role/` - –º–∏–≥—Ä–∞—Ü–∏—è

### Scripts

- `scripts/make-admin.ts` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### Documentation

- `docs/ADMIN_GUIDE.md` - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–î–≤–æ–π–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤:**

   - Backend –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å
   - Frontend —Å–∫—Ä—ã–≤–∞–µ—Ç UI –¥–ª—è –Ω–µ-–∞–¥–º–∏–Ω–æ–≤

2. **Audit logging:**

   - –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–æ–ª–µ–π –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
   - –í—Å–µ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
   - –í –ª–æ–≥–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –≤—ã–ø–æ–ª–Ω–∏–≤—à–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏–µ

3. **–ó–∞—â–∏—Ç–∞ –æ—Ç –æ—à–∏–±–æ–∫:**
   - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–µ –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å —Å–∞–º —Å–µ–±—è
   - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–æ–ª–∏ –Ω–∞ backend
   - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è –Ω–∞ frontend

## üìñ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–º–æ—Ç—Ä–∏—Ç–µ –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –≤ `docs/ADMIN_GUIDE.md` –¥–ª—è:

- –ü–æ–¥—Ä–æ–±–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è API
- –ü—Ä–∏–º–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –†–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- Troubleshooting

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
2. –ù–∞–∑–Ω–∞—á—å—Ç–µ –µ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
3. –í–æ–π–¥–∏—Ç–µ –ø–æ–¥ —ç—Ç–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ —Ä–∞–∑–¥–µ–ª—É "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ"
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞:

- [ ] –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —Ä–æ–ª–µ–π (moderator, analyst, etc.)
- [ ] –î–æ–±–∞–≤–∏—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏ (permissions)
- [ ] –î–æ–±–∞–≤–∏—Ç—å bulk –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∏ –ø–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [ ] –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ audit logs
- [ ] –î–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º (email/push)
